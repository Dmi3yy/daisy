<!DOCTYPE html>
<html lang="[[LANG]]" data-theme="[[THEME]]">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="theme-color" content="#ececec" media="(prefers-color-scheme: light)" />
  <meta name="theme-color" content="#1e1e1e" media="(prefers-color-scheme: dark)" />
  <title>Evolution + DaisyUI 5.7</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/theme-change@2.0.2/index.js"></script>
  <script>
    (function () {
      // Storage keys
      const themeKey = "evo-theme";
      const lightThemeKey = "evo-light-theme";
      const darkThemeKey = "evo-dark-theme";
      const langKey = "evo-lang";
      const paletteKey = "evo-palette";
      const themeVarsKey = "evo-theme-variables";
      const backgroundKey = "evo-background";
      const backgroundColorKey = "evo-background-color";

      // Load saved preferences
      // theme-change uses "theme" key, but we also check our legacy key
      const storedTheme = localStorage.getItem("theme") || localStorage.getItem(themeKey);
      const storedLang = localStorage.getItem(langKey);
      const storedVars = localStorage.getItem(themeVarsKey);

      // Apply saved theme and language
      if (storedTheme) {
        document.documentElement.setAttribute("data-theme", storedTheme);
        // Sync both storage keys
        localStorage.setItem("theme", storedTheme);
        localStorage.setItem(themeKey, storedTheme);
      }
      if (storedLang) document.documentElement.setAttribute("lang", storedLang);
      
      // Apply saved background after DOM is loaded
      const storedBackground = localStorage.getItem(backgroundKey) || 'none';
      window.addEventListener('DOMContentLoaded', function() {
        window.__applyBackground(storedBackground);
        
        // Initialize background checkmarks
        document.querySelectorAll('.bg-item').forEach(btn => {
          const checkmark = btn.querySelector('.bg-checkmark');
          if (checkmark) {
            if (btn.getAttribute('data-bg') === storedBackground) {
              checkmark.style.opacity = '1';
            } else {
              checkmark.style.opacity = '0';
            }
          }
        });
        
        // Initialize HSL sliders with saved values
        const savedHue = localStorage.getItem('evo-solid-hue') || 220;
        const savedOpacity = localStorage.getItem('evo-solid-opacity') || 100;
        
        const hueSlider = document.getElementById('hue-slider');
        const opacitySlider = document.getElementById('opacity-slider');
        
        if (hueSlider) hueSlider.value = savedHue;
        if (opacitySlider) opacitySlider.value = savedOpacity;
        
        // Update displays and slider colors
        if (window.__applySolidColorRealtime) {
          window.__applySolidColorRealtime();
        }
      });
      
      // Evo Theme Effects Management
      const evoDepthKey = 'evo-depth';
      const evoNoiseKey = 'evo-noise';
      
      // Apply theme effects
      window.__applyEvoEffects = function() {
        const depth = localStorage.getItem(evoDepthKey) === 'true' ? '1' : '0';
        const noise = localStorage.getItem(evoNoiseKey) === 'true' ? '1' : '0';
        
        // Create or update style element for Evo effects
        let style = document.getElementById('evo-effects-style');
        if (!style) {
          style = document.createElement('style');
          style.id = 'evo-effects-style';
          document.head.appendChild(style);
        }
        
        style.textContent = `:root {
          --depth: ${depth} !important;
          --noise: ${noise} !important;
        }`;
        
        console.log(`🎨 Evo Effects: depth=${depth}, noise=${noise}`);
      };
      
      // Start Evo Auto Mode if it was active
      window.addEventListener('DOMContentLoaded', function() {
        const evoSpeed = parseFloat(localStorage.getItem('evo-speed') || '0');
        
        // Update slider and display
        const slider = document.getElementById('evo-speed-slider');
        const speedDisplay = document.getElementById('evo-speed-display');
        
        if (slider) {
          slider.value = evoSpeed;
        }
        
        if (speedDisplay) {
          speedDisplay.textContent = evoSpeed === 0 ? 'OFF' : `${evoSpeed.toFixed(1)}s`;
        }
        
        // Initialize system effect toggles
        const depthToggle = document.getElementById('system-depth-toggle');
        const noiseToggle = document.getElementById('system-noise-toggle');
        
        if (depthToggle) {
          const depth = localStorage.getItem(evoDepthKey) !== 'false'; // Default true
          depthToggle.checked = depth;
          localStorage.setItem(evoDepthKey, depth);
        }
        
        if (noiseToggle) {
          const noise = localStorage.getItem(evoNoiseKey) === 'true'; // Default false
          noiseToggle.checked = noise;
          localStorage.setItem(evoNoiseKey, noise);
        }
        
        // Apply effects
        window.__applyEvoEffects();
        
        // Add event listeners for effect toggles
        if (depthToggle) {
          depthToggle.addEventListener('change', function(e) {
            localStorage.setItem(evoDepthKey, e.target.checked);
            window.__applyEvoEffects();
          });
        }
        
        if (noiseToggle) {
          noiseToggle.addEventListener('change', function(e) {
            localStorage.setItem(evoNoiseKey, e.target.checked);
            window.__applyEvoEffects();
          });
        }
        
        // Start Evo Auto if speed > 0
        if (evoSpeed > 0 && window.__startEvoAuto) {
          window.__startEvoAuto(evoSpeed);
          if (evoButton) evoButton.classList.add('btn-primary');
        }
      });

      // Apply custom theme variables
      if (storedVars) {
        try {
          const vars = JSON.parse(storedVars);
          const style = document.createElement('style');
          style.id = 'evo-custom-vars';
          let css = ':root[data-theme="' + (storedTheme || '[[THEME]]') + '"] {';
          Object.keys(vars).forEach(key => {
            css += key + ':' + vars[key] + ';';
          });
          css += '}';
          style.textContent = css;
          document.head.appendChild(style);
        } catch (e) {
          console.error('Failed to parse theme variables:', e);
        }
      }

      // Theme modes mapping - dynamically loaded from theme files
      /* @@THEME_LISTS */
      const lightThemes = __lightThemes || [];
      const darkThemes = __darkThemes || [];

      // Global functions for theme/lang switching
      // theme-change library handles the actual theme switching, but we need to track light/dark preferences
      window.__setTheme = function (t) {
        // Let theme-change handle the actual setting
        document.documentElement.setAttribute("data-theme", t);
        localStorage.setItem("theme", t); // theme-change uses "theme" key
        localStorage.setItem(themeKey, t); // Keep our legacy key too
        
        // Save theme based on mode for light/dark memory
        if (lightThemes.includes(t)) {
          localStorage.setItem(lightThemeKey, t);
        } else if (darkThemes.includes(t)) {
          localStorage.setItem(darkThemeKey, t);
        }
        
        // Reapply custom variables for new theme
        const vars = localStorage.getItem(themeVarsKey);
        if (vars) {
          const style = document.getElementById('evo-custom-vars');
          if (style) {
            const varsObj = JSON.parse(vars);
            let css = ':root[data-theme="' + t + '"] {';
            Object.keys(varsObj).forEach(key => {
              css += key + ':' + varsObj[key] + ';';
            });
            css += '}';
            style.textContent = css;
          }
        }
      };
      
      // Watch for theme changes from theme-change library
      const themeObserver = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            const newTheme = document.documentElement.getAttribute('data-theme');
            if (newTheme) {
              // Save last theme for light/dark mode
              if (lightThemes.includes(newTheme)) {
                localStorage.setItem(lightThemeKey, newTheme);
              } else if (darkThemes.includes(newTheme)) {
                localStorage.setItem(darkThemeKey, newTheme);
              }
              localStorage.setItem(themeKey, newTheme);
            }
          }
        });
      });
      
      // Start observing theme changes
      themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['data-theme']
      });
      
      window.__getLastThemeForMode = function(mode) {
        if (mode === 'light') {
          return localStorage.getItem(lightThemeKey) || 'light';
        } else if (mode === 'dark') {
          return localStorage.getItem(darkThemeKey) || 'dark';
        }
        return 'light';
      };

      window.__setLang = function (l) {
        document.documentElement.setAttribute("lang", l);
        localStorage.setItem(langKey, l);
      };

      window.__setBackground = function (bg) {
        localStorage.setItem(backgroundKey, bg);
        __applyBackground(bg);
        
        // Update background checkmarks
        document.querySelectorAll('.bg-item').forEach(btn => {
          const checkmark = btn.querySelector('.bg-checkmark');
          if (checkmark) {
            if (btn.getAttribute('data-bg') === bg) {
              checkmark.style.opacity = '1';
            } else {
              checkmark.style.opacity = '0';
            }
          }
        });
      };

      window.__applyBackground = function(bgId) {
        const container = document.getElementById('app-background');
        if (!container) return;

        // Stop cosmic dream if it was active
        if (window.__stopCosmicDream) {
          window.__stopCosmicDream();
        }

        // Create layer structure if it doesn't exist
        let layersContainer = container.querySelector('.background-layers');
        let animatedLayer = container.querySelector('.animated-layer');
        let solidLayer = container.querySelector('.solid-layer');
        
        if (!layersContainer) {
          layersContainer = document.createElement('div');
          layersContainer.className = 'background-layers';
          container.appendChild(layersContainer);
        }
        
        if (!animatedLayer) {
          animatedLayer = document.createElement('div');
          animatedLayer.className = 'animated-layer';
          layersContainer.appendChild(animatedLayer);
        }
        
        if (!solidLayer) {
          solidLayer = document.createElement('div');
          solidLayer.className = 'solid-layer';
          layersContainer.appendChild(solidLayer);
        }

        // Save last animated background for transparent mode
        const animatedBackgrounds = ['gradient-spheres', 'colorful-dots', 'cosmic-dream'];
        if (animatedBackgrounds.includes(bgId)) {
          localStorage.setItem('evo-last-animated-bg', bgId);
        }

        if (bgId === 'none' || !bgId) {
          // Clear both layers
          animatedLayer.innerHTML = '';
          animatedLayer.className = 'animated-layer';
          solidLayer.style.background = '';
          // Disable glass surfaces when no dynamic background
          document.body.classList.remove('has-dynamic-bg');
          return;
        }

        // Mark page as having a dynamic background (enables glass UI surfaces)
        document.body.classList.add('has-dynamic-bg');

        if (bgId === 'transparent') {
          // Clear solid layer, keep animated
          solidLayer.style.background = '';
          document.body.classList.add('has-dynamic-bg');
        } else if (bgId === 'solid-color') {
          // Apply solid color layer on top
          const hue = localStorage.getItem('evo-solid-hue') || 220;
          const opacity = localStorage.getItem('evo-solid-opacity') || 100;
          const alpha = opacity / 100;
          const color = `hsla(${hue}, 80%, 60%, ${alpha})`;
          
          solidLayer.style.background = color;
          
          // Enable glass effects if opacity < 100 (semi-transparent)
          if (alpha < 1) {
            document.body.classList.add('has-dynamic-bg');
          } else {
            document.body.classList.remove('has-dynamic-bg');
          }
        } else if (bgId === 'gradient-spheres') {
          // Clear solid layer, apply animated
          solidLayer.style.background = '';
          animatedLayer.className = 'animated-layer bg-gradient-spheres';
          animatedLayer.innerHTML = `
            <div class="gradient-sphere sphere-1"></div>
            <div class="gradient-sphere sphere-2"></div>
            <div class="gradient-sphere sphere-3"></div>
            <div class="glow"></div>
            <div class="grid-overlay"></div>
            <div class="noise-overlay"></div>
            <div class="particles-container" id="particles-container"></div>
          `;
          __initGradientSpheresParticles();
        } else if (bgId === 'colorful-dots') {
          // Clear solid layer, apply animated
          solidLayer.style.background = '';
          animatedLayer.className = 'animated-layer bg-colorful-dots';
          animatedLayer.innerHTML = `
            <div class="dots-layer dots-layer-1">.</div>
            <div class="dots-layer dots-layer-2">.</div>
            <div class="dots-layer dots-layer-3">.</div>
            <div class="dots-layer dots-layer-4">.</div>
          `;
        } else if (bgId === 'cosmic-dream') {
          // Clear solid layer, apply animated
          solidLayer.style.background = '';
          animatedLayer.className = 'animated-layer bg-cosmic-dream';
          animatedLayer.innerHTML = `
            <div class="cosmic-spheres">
              <div class="cosmic-sphere cosmic-sphere-1"></div>
              <div class="cosmic-sphere cosmic-sphere-2"></div>
              <div class="cosmic-sphere cosmic-sphere-3"></div>
            </div>
            <div class="cosmic-dots cosmic-dots-1">.</div>
            <div class="cosmic-dots cosmic-dots-2">.</div>
          `;
          __initCosmicDream();
        }
        
        // Add glass effect to hero when background is active
        const hero = document.querySelector('.hero');
        if (hero && bgId && bgId !== 'none') {
          hero.classList.add('hero-glass');
        } else if (hero) {
          hero.classList.remove('hero-glass');
        }
      };

      // Apply solid color in real-time (without saving to localStorage)
      window.__applySolidColorRealtime = function() {
        const hue = document.getElementById('hue-slider')?.value || 220;
        const opacity = document.getElementById('opacity-slider')?.value || 100;
        const alpha = opacity / 100;
        
        // Update display values (main and mini)
        const hueDisplay = document.getElementById('hue-value');
        const hueDisplayMini = document.getElementById('hue-value-mini');
        const opacityDisplay = document.getElementById('opacity-value');
        const hueSlider = document.getElementById('hue-slider');
        const opacitySlider = document.getElementById('opacity-slider');
        
        if (hueDisplay) hueDisplay.textContent = `${hue}°`;
        if (hueDisplayMini) hueDisplayMini.textContent = `${hue}°`;
        if (opacityDisplay) opacityDisplay.textContent = `${opacity}%`;
        
        // Update both sliders with current color
        const color = `hsl(${hue}, 80%, 60%)`;
        
        // Hue slider thumb
        if (hueSlider) {
          hueSlider.style.setProperty('--thumb-color', color);
        }
        
        // Opacity slider - thumb (full color) and background gradient
        if (opacitySlider) {
          opacitySlider.style.setProperty('--thumb-color', color);
          opacitySlider.style.setProperty('--gradient-color', color);
        }
        
        // Get solid layer
        const container = document.getElementById('app-background');
        if (!container) return;
        
        let solidLayer = container.querySelector('.solid-layer');
        if (!solidLayer) {
          // Create layer structure if needed
          __applyBackground('none');
          solidLayer = container.querySelector('.solid-layer');
        }
        
        // Apply color to solid layer
        const colorWithAlpha = `hsla(${hue}, 80%, 60%, ${alpha})`;
        if (solidLayer) {
          solidLayer.style.background = colorWithAlpha;
        }
        
        // Enable glass effects if opacity < 100
        if (alpha < 1) {
          document.body.classList.add('has-dynamic-bg');
        } else {
          document.body.classList.remove('has-dynamic-bg');
        }
      };
      
      // Save solid color settings to localStorage
      window.__saveSolidColorToStorage = function() {
        const hue = document.getElementById('hue-slider')?.value || 220;
        const opacity = document.getElementById('opacity-slider')?.value || 100;
        
        localStorage.setItem('evo-solid-hue', hue);
        localStorage.setItem('evo-solid-opacity', opacity);
        localStorage.setItem(backgroundKey, 'solid-color-layer');
        
        console.log(`💾 Saved: H${hue}° O${opacity}%`);
        
        // Visual feedback
        const btn = event?.target;
        if (btn) {
          const originalText = btn.innerHTML;
          btn.innerHTML = '✅ Saved!';
          btn.classList.add('btn-success');
          setTimeout(() => {
            btn.innerHTML = originalText;
            btn.classList.remove('btn-success');
          }, 1500);
        }
      };
      
      // Legacy function for backward compatibility
      window.__setBackgroundColor = function(hex) {
        try {
          localStorage.setItem(backgroundColorKey, hex);
          const active = localStorage.getItem(backgroundKey);
          if (active === 'solid-color') {
            __applyBackground('solid-color');
          }
        } catch (e) {
          console.error('Failed to save background color', e);
        }
      }

      window.__initCosmicDream = function() {
        function getRandomColor() {
          return Math.floor(Math.random() * 360);
        }
        
        function updateCosmicColors() {
          const root = document.documentElement;
          const spheres = document.querySelectorAll('.cosmic-sphere');
          
          // Update sphere colors
          if (spheres[0]) {
            const c1 = getRandomColor();
            spheres[0].style.background = `radial-gradient(circle, hsla(${c1}, 80%, 60%, 0.8), hsla(${c1 + 30}, 80%, 50%, 0.4))`;
          }
          if (spheres[1]) {
            const c2 = getRandomColor();
            spheres[1].style.background = `radial-gradient(circle, hsla(${c2}, 80%, 60%, 0.8), hsla(${c2 + 30}, 80%, 50%, 0.4))`;
          }
          if (spheres[2]) {
            const c3 = getRandomColor();
            spheres[2].style.background = `radial-gradient(circle, hsla(${c3}, 80%, 60%, 0.8), hsla(${c3 + 30}, 80%, 50%, 0.4))`;
          }
          
          // Update dots colors via CSS variables
          for (let i = 1; i <= 10; i++) {
            root.style.setProperty(`--cosmic-hue-${i}`, getRandomColor());
          }
          
          // Change background color
          const bgContainer = document.querySelector('.bg-cosmic-dream');
          if (bgContainer) {
            const bgHue = getRandomColor();
            bgContainer.style.background = `linear-gradient(135deg, 
              hsla(${bgHue}, 60%, 12%, 1) 0%, 
              hsla(${bgHue + 60}, 50%, 15%, 1) 50%, 
              hsla(${bgHue + 120}, 60%, 10%, 1) 100%)`;
          }
        }
        
        // Initial colors
        updateCosmicColors();
        
        // Change colors every 8 seconds
        const colorInterval = setInterval(updateCosmicColors, 8000);
        
        // Store interval ID to stop it later
        window.__cosmicColorInterval = colorInterval;
      };
      
      window.__stopCosmicDream = function() {
        if (window.__cosmicColorInterval) {
          clearInterval(window.__cosmicColorInterval);
          window.__cosmicColorInterval = null;
        }
        if (window.__evoAutoInterval) {
          clearInterval(window.__evoAutoInterval);
          window.__evoAutoInterval = null;
        }
        document.documentElement.style.transition = '';
      };

      // Update transition duration based on Evo speed
      window.__updateTransitionDuration = function(speedSeconds) {
        // Calculate transition duration to be 80% of rotation time
        // 20% static + 80% smooth transition to next theme
        let duration;
        if (speedSeconds === 0) {
          duration = 500; // Default when Evo is off (0.5s)
        } else {
          // Use 80% of the rotation speed for smooth transition
          // e.g., 1s = 800ms, 3s = 2400ms, 6s = 4800ms, 10s = 8000ms
          duration = Math.round(speedSeconds * 800);
        }
        
        document.documentElement.style.setProperty('--theme-transition-duration', `${duration}ms`);
        console.log(`⏱️ Transition: ${(duration/1000).toFixed(1)}s (80% of ${speedSeconds}s rotation)`);
      };
      
      // Evo Auto Mode - Theme switching with configurable speed
      (function() {
        let evoInterval = null;
        
        function getCurrentModeThemes() {
          const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
          return darkThemes.includes(currentTheme) ? darkThemes : lightThemes;
        }

        function pickNextTheme(current) {
          const themeList = getCurrentModeThemes();
          let next;
          do {
            next = themeList[Math.floor(Math.random() * themeList.length)];
          } while (next === current && themeList.length > 1);
          return next;
        }
        
        window.__startEvoAuto = function(speedSeconds) {
          window.__stopEvoAuto(); // Stop if already running
          
          if (!speedSeconds || speedSeconds === 0) {
            console.log('🎨 Evo Auto Mode: Speed is 0, not starting');
            window.__updateTransitionDuration(0); // Reset to default
            return;
          }
          
          // Update transition duration based on speed
          window.__updateTransitionDuration(speedSeconds);
          
          console.log(`🎨 Evo Auto Mode: ON - switching themes every ${speedSeconds}s`);
          
          // Switch theme immediately
          const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
          const nextTheme = pickNextTheme(currentTheme);
          window.__setTheme(nextTheme);
          
          // Then switch at specified interval
          evoInterval = setInterval(() => {
            const current = document.documentElement.getAttribute('data-theme');
            const next = pickNextTheme(current);
            window.__setTheme(next);
            console.log(`🎨 Evo Auto: Switched to ${next}`);
          }, speedSeconds * 1000); // Convert to milliseconds
        };
        
        window.__stopEvoAuto = function() {
          if (evoInterval) {
            clearInterval(evoInterval);
            evoInterval = null;
            window.__updateTransitionDuration(0); // Reset to default
            console.log("🎨 Evo Auto Mode: OFF");
          }
        };
        
        // Handle speed slider changes
        window.__updateEvoUI = function(speed) {
          const speedValue = document.getElementById('evo-speed-value');
          const statusBadge = document.getElementById('evo-status-badge');
          const evoButton = document.getElementById('evo-button');
          
          if (speed === 0) {
            if (speedValue) speedValue.textContent = '0s (OFF)';
            if (statusBadge) {
              statusBadge.textContent = 'OFF';
              statusBadge.classList.remove('badge-success');
              statusBadge.classList.add('badge-primary');
            }
            if (evoButton) evoButton.classList.remove('btn-primary');
          } else {
            if (speedValue) speedValue.textContent = `${speed}s`;
            if (statusBadge) {
              statusBadge.textContent = 'ON';
              statusBadge.classList.remove('badge-primary');
              statusBadge.classList.add('badge-success');
            }
            if (evoButton) evoButton.classList.add('btn-primary');
          }
        };
        
        // Speed slider handler
        window.addEventListener('DOMContentLoaded', function() {
          const slider = document.getElementById('evo-speed-slider');
          if (slider) {
            slider.addEventListener('input', function(e) {
              const speed = parseInt(e.target.value, 10);
              localStorage.setItem('evo-speed', speed);
              window.__updateEvoUI(speed);
              
              // Restart Evo Auto with new speed
              if (speed > 0) {
                window.__startEvoAuto(speed);
              } else {
                window.__stopEvoAuto();
              }
            });
          }
        });
      })();

      window.__initGradientSpheresParticles = function() {
        const particlesContainer = document.getElementById('particles-container');
        if (!particlesContainer) return;
        
        const particleCount = 80;
        
        // Create particles
        for (let i = 0; i < particleCount; i++) {
          createParticle();
        }
        
        function createParticle() {
          const particle = document.createElement('div');
          particle.className = 'particle';
          
          const size = Math.random() * 3 + 1;
          particle.style.width = size + 'px';
          particle.style.height = size + 'px';
          
          resetParticle(particle);
          particlesContainer.appendChild(particle);
          animateParticle(particle);
        }
        
        function resetParticle(particle) {
          const posX = Math.random() * 100;
          const posY = Math.random() * 100;
          
          particle.style.left = posX + '%';
          particle.style.top = posY + '%';
          particle.style.opacity = '0';
          
          return { x: posX, y: posY };
        }
        
        function animateParticle(particle) {
          const pos = resetParticle(particle);
          const duration = Math.random() * 10 + 10;
          const delay = Math.random() * 5;
          
          setTimeout(() => {
            particle.style.transition = 'all ' + duration + 's linear';
            particle.style.opacity = Math.random() * 0.3 + 0.1;
            
            const moveX = pos.x + (Math.random() * 20 - 10);
            const moveY = pos.y - Math.random() * 30;
            
            particle.style.left = moveX + '%';
            particle.style.top = moveY + '%';
            
            setTimeout(() => animateParticle(particle), duration * 1000);
          }, delay * 1000);
        }
        
        // Mouse interaction
        document.addEventListener('mousemove', function(e) {
          const mouseX = (e.clientX / window.innerWidth) * 100;
          const mouseY = (e.clientY / window.innerHeight) * 100;
          
          const particle = document.createElement('div');
          particle.className = 'particle';
          
          const size = Math.random() * 4 + 2;
          particle.style.width = size + 'px';
          particle.style.height = size + 'px';
          particle.style.left = mouseX + '%';
          particle.style.top = mouseY + '%';
          particle.style.opacity = '0.6';
          
          particlesContainer.appendChild(particle);
          
          setTimeout(() => {
            particle.style.transition = 'all 2s ease-out';
            particle.style.left = (mouseX + (Math.random() * 10 - 5)) + '%';
            particle.style.top = (mouseY + (Math.random() * 10 - 5)) + '%';
            particle.style.opacity = '0';
            
            setTimeout(() => particle.remove(), 2000);
          }, 10);
        });
      };

      window.__setThemeVar = function (key, value) {
        const vars = JSON.parse(localStorage.getItem(themeVarsKey) || '{}');
        vars[key] = value;
        localStorage.setItem(themeVarsKey, JSON.stringify(vars));
        
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const style = document.getElementById('evo-custom-vars') || document.createElement('style');
        style.id = 'evo-custom-vars';
        let css = ':root[data-theme="' + currentTheme + '"] {';
        Object.keys(vars).forEach(k => {
          css += k + ':' + vars[k] + ';';
        });
        css += '}';
        style.textContent = css;
        if (!style.parentNode) document.head.appendChild(style);
      };

      window.__exportTheme = function () {
        const theme = localStorage.getItem(themeKey) || '[[THEME]]';
        const palette = localStorage.getItem(paletteKey) || 'default';
        const vars = JSON.parse(localStorage.getItem(themeVarsKey) || '{}');
        const exportData = {
          name: theme,
          palette: palette,
          vars: vars
        };
        const dataStr = JSON.stringify(exportData, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
        const exportFileDefaultName = 'evo-theme-' + theme + '.json';
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
      };

      window.__importTheme = function (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const data = JSON.parse(e.target.result);
            if (data.name) __setTheme(data.name);
            if (data.palette) __setPalette(data.palette);
            if (data.vars) {
              localStorage.setItem(themeVarsKey, JSON.stringify(data.vars));
              Object.keys(data.vars).forEach(key => {
                __setThemeVar(key, data.vars[key]);
              });
            }
            alert('Theme imported successfully!');
            location.reload();
          } catch (err) {
            alert('Failed to import theme: ' + err.message);
          }
        };
        reader.readAsText(file);
      };
    })();
  </script>
</head>
<body class="min-h-screen">
  <!-- Animated Background Container -->
  <div id="app-background"></div>
  
  <div class="drawer drawer-end">
    <input id="settings-drawer" type="checkbox" class="drawer-toggle" />
    
    <div class="drawer-content">
      <!-- @@NAVBAR -->
      <main class="container mx-auto px-4 py-8">
        <!-- @@CONTENT -->
      </main>
      <!-- @@FOOTER -->
    </div>
    
    <div class="drawer-side z-50">
      <label for="settings-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
      <div class="bg-base-100 min-h-full w-96 p-6 overflow-y-auto">
        <!-- @@SETTINGS -->
      </div>
    </div>
  </div>
</body>
</html>

